<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="../../cb/images/favico1.png" rel="apple-touch-icon" sizes="180x180" />
  <link href="../../cb/images/favico1.png" rel="icon" sizes="32x32" type="image/png" />
  <link href="../../cb/images/favico1.png" rel="icon" sizes="16x16" type="image/png" />
  <title>Unicorn • Members Area</title>
  <style>
    :root {
      --bg: #0b0a0a;
      --panel: #151313;
      --text: #f5f4f2;
      --muted: #cfc7be;
      --line: rgba(255, 255, 255, .08);
      --pink: #f06292;
      --shadow: 0 12px 28px rgba(0, 0, 0, .45);
      --radius: 16px;
      --pink-1: #ffa3c0;
      /* light end */
      --pink-2: #f06292;
      /* deep end */
      --tab-ink: #1b1330;
      /* text on pink */
    }

    * {
      box-sizing: border-box
    }

    html,
    body {
      height: 100%
    }

    body {
      margin: 0;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      font: 500 16px/1.55 Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text)
    }


    a {
      color: inherit;
      text-decoration: none
    }

    button {
      font: inherit
    }

    .wrap {
      width: min(980px, 100%);
      margin-inline: auto;
      padding: 0 20px
    }

    header {
      position: relative;
      background: linear-gradient(180deg, rgba(15, 13, 13, .95), rgba(11, 10, 10, .7));
      border-bottom: 1px solid var(--line)
    }

    .bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      min-height: 62px
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px
    }

    .logo {
      width: 34px;
      height: 34px;
      border-radius: 10px;
      background: var(--pink);
      border: 1px solid var(--line)
    }

    .support {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 9px 12px;
      border-radius: 12px;
      background: var(--pink);
      color: #fff;
      font-weight: 800
    }

    main {
      flex: 1;
      display: block
    }

    /* Red blinking dot for LIVE SALES tab */
    #tabs .tab[data-sales] {
      position: relative;
      padding-left: 30px;
      /* more space for the dot */
    }

    #tabs .tab[data-sales]::before {
      content: "";
      position: absolute;
      left: 12px;
      /* distance from the button’s left edge */
      top: 50%;
      transform: translateY(-50%);
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: red;
      box-shadow: 0 0 0 0 rgba(255, 0, 0, .45);
      animation: pulse-red 1.8s ease-out infinite;
    }

    @keyframes pulse-red {
      0% {
        box-shadow: 0 0 0 0 rgba(255, 0, 0, .45);
      }

      70% {
        box-shadow: 0 0 0 10px rgba(255, 0, 0, 0);
      }

      100% {
        box-shadow: 0 0 0 0 rgba(255, 0, 0, 0);
      }
    }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
      margin: 20px auto 8px
    }

    .tab {
      padding: 10px 14px;
      border-radius: 999px;
      background: rgba(255, 255, 255, .05);
      border: 1px solid var(--line);
      color: #efe6dc;
      font-weight: 900;
      letter-spacing: .25px
    }

    #tabs .tab {
      background: #111;
      color: #d9d9d9;
      border: 1px solid #262626;
      transition: transform .15s ease, box-shadow .15s ease, filter .15s ease;
    }

    /* selected tab gets gradient pink button */
    #tabs .tab.active {
      background-image: linear-gradient(135deg, var(--pink-1) 0%, var(--pink-2) 100%);
      color: var(--tab-ink);
      border-color: transparent;
      box-shadow: 0 10px 22px rgba(240, 98, 146, .35);
    }

    /* polish */
    #tabs .tab.active:hover {
      filter: brightness(1.03);
      transform: translateY(-1px);
    }

    #tabs .tab:focus-visible {
      outline: 2px solid var(--pink-2);
      outline-offset: 2px;
    }

    .tab.active {
      background: var(--pink);
      border-color: rgba(255, 255, 255, .18);
      box-shadow: 0 8px 20px rgba(240, 98, 146, .25);
      color: #1b0f14
    }

    /* Module info */
    .module-info {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      margin: 6px auto 10px;
      font-size: 14px;
      color: #dcd5cf;
      flex-wrap: wrap;
      margin-top: 20px;
    }

    .module-info .label {
      letter-spacing: .12em;
      text-transform: uppercase;
      color: #bfb7af;
      font-weight: 700;
      font-size: 12px
    }

    .module-info .value {
      font-weight: 800;
      color: #f5f4f2
    }

    .module-info .sep {
      opacity: .35
    }

    .module-info .now {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      color: #f5f4f2
    }

    .module-info .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--pink);
      box-shadow: 0 0 0 0 rgba(240, 98, 146, .45);
      animation: pulse 1.8s ease-out infinite
    }

    .module-info .fraction {
      font-weight: 900;
      color: #f5f4f2;
      font-variant-numeric: tabular-nums
    }

    .module-info .fraction .cur {
      color: var(--pink)
    }

    .module-info .slash {
      opacity: .5;
      padding: 0 2px
    }

    .module-info .now .tag {
      font-weight: 800;
      letter-spacing: .06em;
      text-transform: uppercase;
      color: #e8dee1;
      background-image: linear-gradient(var(--pink), var(--pink));
      background-size: 100% 2px;
      background-repeat: no-repeat;
      background-position: 0 105%;
      padding-bottom: 2px
    }

    @keyframes pulse {
      0% {
        box-shadow: 0 0 0 0 rgba(240, 98, 146, .45)
      }

      70% {
        box-shadow: 0 0 0 10px rgba(240, 98, 146, 0)
      }

      100% {
        box-shadow: 0 0 0 0 rgba(240, 98, 146, 0)
      }
    }

    .progress {
      position: relative;
      height: 6px;
      border-radius: 999px;
      background: rgba(255, 255, 255, .06);
      border: 1px solid var(--line);
      overflow: hidden;
      width: min(680px, 92%);
      margin: 8px auto 0
    }

    .progress .bar {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, rgba(240, 98, 146, .2), var(--pink));
      transition: width .35s ease
    }

    /* Player card */
    .player-card {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 14px;
      box-shadow: var(--shadow);
      overflow: hidden;
      margin-top: 20px;
    }

    .frame {
      position: relative;
      width: 100%;
      aspect-ratio: 16/9;
      background: #000
    }

    .frame iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      transition: opacity .28s ease
    }

    .frame iframe.loaded {
      opacity: 1
    }

    .content {
      padding: 16px
    }

    .title {
      margin: 0 0 6px;
      font-weight: 900;
      font-size: 22px
    }

    .desc {
      margin: 0;
      color: #e9e0d5;
      font-size: 15px
    }

    .meta {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-top: 10px;
      color: #d7cfc6;
      font-size: 13px
    }

    .logo {
      width: 34px;
      height: 34px;
      border-radius: 10px;
      background: var(--pink);
      border: 1px solid var(--line);

      /* center the emoji */
      display: grid;
      place-items: center;

      /* make it crisp */
      font-size: 18px;
      line-height: 1;
      color: #1a0d13;
      /* or #fff if you prefer */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .15);
    }

    /* Controls */
    .controls {
      display: flex;
      align-items: center;
      gap: 14px;
      justify-content: center;
      margin: 16px 0 26px
    }

    .pill {
      padding: 10px 16px;
      border-radius: 999px;
      background: rgba(255, 255, 255, .06);
      border: 1px solid var(--line);
      color: #efe6dc;
      font-weight: 800
    }

    .pill:hover {
      transform: translateY(-1px)
    }

    @media (prefers-reduced-motion: reduce) {
      .module-info .dot {
        animation: none
      }
    }

    @media (max-width:720px) {
      .module-info {
        gap: 10px;
        font-size: 13px
      }

      .title {
        font-size: 20px
      }
    }

    /* Live Sales */
    .sales-panel {
      display: none;
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 14px;
      box-shadow: var(--shadow);
      overflow: hidden;
      margin-top: 14px;
    }

    .sales-head {
      display: grid;
      grid-template-columns: 60px 1.2fr 1.3fr 140px 140px;
      gap: 0;
      background: #b04569;
      color: #eef5ff;
      font-weight: 900;
      letter-spacing: .2px;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(255, 255, 255, .12);
    }

    .sales-body {
      display: block;
      max-height: 520px;
      overflow: auto;
      scrollbar-width: thin;
    }

    .sales-row {
      display: grid;
      grid-template-columns: 60px 1.2fr 1.3fr 140px 140px;
      gap: 0;
      align-items: center;
      padding: 12px 14px;
      border-bottom: 1px solid var(--line);
      color: #f5f4f2;
    }

    .sales-row:nth-child(odd) {
      background: rgba(255, 255, 255, .02);
    }

    .sales-rank {
      font-weight: 900;
      color: #f06292;
    }

    .sales-amount {
      font-variant-numeric: tabular-nums;
      font-weight: 900;
    }

    .sales-time {
      color: #d7cfc6;
      font-variant-numeric: tabular-nums;
    }

    .sales-ping {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 800;
    }

    .sales-ping .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--pink);
      box-shadow: 0 0 0 0 rgba(240, 98, 146, .45);
      animation: pulse 1.8s ease-out infinite;
    }

    .sales-title {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 0 4px;
      font-weight: 900;
      font-size: 22px;
    }

    .sales-muted {
      color: #cfc7be;
    }

    .sales-legend {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-top: 8px;
      padding: 0 2px 10px;
      border-bottom: 1px solid var(--line);
    }

    .sales-actions {
      display: none;
    }

    .sales-pill {
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255, 255, 255, .06);
      color: #efe6dc;
      font-weight: 800;
      cursor: pointer;
    }



    /* Live Sales background banner under header (behind main content area) */
    /* Full-width banner only on Live Sales page */
    /* Live Sales background */
    body.sales-mode {
      background: none;
      /* remove default gradient */
      position: relative;
    }

    /* Background + white fade only on Live Sales */
    body.sales-mode::before {
      content: "";
      position: absolute;
      top: 63px;
      /* just under header */
      left: 0;
      width: 101%;
      height: 350px;
      background:
        linear-gradient(to top, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 200px),
        url('../../cb/images/bga20.png') no-repeat center top;
      background-size: cover;
      z-index: -1;
      /* behind the dashboard */
    }

    /* Make all monetary amounts on Live Sales green */
    .sales-panel .sales-amount,
    .sales-panel [data-col="amount"],
    .sales-panel .amount {
      color: #22c55e !important;
      /* green */
      font-weight: 800;
    }

    /* Hover effect for non-active tabs */
    /* Shine hover for non-active tabs */
    #tabs .tab:not(.active) {
      position: relative;
      overflow: hidden;
    }

    #tabs .tab:not(.active)::after {
      content: "";
      position: absolute;
      top: 0;
      left: -75%;
      width: 50%;
      height: 100%;
      background: linear-gradient(120deg,
          rgba(255, 255, 255, 0) 0%,
          rgba(255, 255, 255, 0.6) 50%,
          rgba(255, 255, 255, 0) 100%);
      transform: skewX(-25deg);
    }

    #tabs .tab:not(.active):hover::after {
      left: 125%;
      transition: left 0.6s ease;
    }
  
/* --- Added: Resources, Tip, Teaser, Badges --- */
.resources{ margin-top:16px; padding:12px 12px 6px; border-top:1px solid var(--line); background:rgba(255,255,255,.02); border-radius:12px; }
.resources h3{ margin:0 0 8px; font-size:16px; font-weight:900; color:var(--pink); }
.resources ul{ list-style:none; margin:0; padding:0; display:grid; gap:8px; }
.resources .pill-link{ display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; border:1px solid var(--line); background:rgba(255,255,255,.05); color:var(--text); font-weight:800; text-decoration:none; }
.resources .pill-link:hover{ transform: translateY(-1px); }
.resources .kind{ opacity:.8; font-weight:700; letter-spacing:.04em; font-size:12px; text-transform:uppercase; }

.tip{ margin-top:12px; padding:10px 12px; border:1px solid var(--line); border-radius:10px; background:rgba(255,255,255,.03); color:#e9e0d5; font-size:14px; }
.tip b{ color:var(--pink); }

.teaser{ margin-top:12px; padding:12px; border:1px dashed var(--line); border-radius:12px; background:rgba(255,255,255,.03); color:#e9e0d5; }
.teaser b{ color:var(--pink); }

.badges{ margin-top:10px; display:flex; flex-wrap:wrap; gap:8px; }
.badge{ display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; border:1px solid var(--line); background:rgba(255,255,255,.05); font-weight:800; }
.badge i{ color:#ffd166; }

  
/* ---- Lesson completion toggle ---- */
.complete-toggle{
  display:inline-flex; align-items:center; gap:10px;
  margin-top:10px; padding:8px 12px; border-radius:10px;
  border:1px solid var(--line); background:rgba(255,255,255,.03);
  font-weight:800; color:#e9e0d5; cursor:pointer;
}
.complete-toggle input{ width:18px; height:18px; accent-color: var(--pink); }

/* blue/violet */
.badge[data-b="m3"]{ background: linear-gradient(135deg, rgba(190,242,100,.18), rgba(34,197,94,.12)); } /* green */
.badge[data-b="m4"]{ background: linear-gradient(135deg, rgba(253,186,116,.18), rgba(245,158,11,.12)); } /* orange */
.badge[data-b="m5"]{ background: linear-gradient(135deg, rgba(196,181,253,.18), rgba(168,85,247,.12)); } /* purple */
.badge i{ opacity:.9; }

  
/* ---- Badges: compact pastel gradient redesign ---- */
.badges {
  margin-top: 8px;
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}
.badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 13px;
  font-weight: 700;
  border: 1px solid rgba(255,255,255,.1);
  background: linear-gradient(135deg, rgba(255,163,192,.15), rgba(240,98,146,.08));
  color: #f8e9f0;
  box-shadow: inset 0 1px 2px rgba(255,255,255,.05),
              0 1px 2px rgba(0,0,0,.2);
  transition: all 0.2s ease;
}
.badge:hover {
  transform: translateY(-1px);
  box-shadow: inset 0 1px 3px rgba(255,255,255,.08),
              0 3px 6px rgba(0,0,0,.25);
}
.badge i {
  font-size: 12px;
  opacity: 0.5; /* blend icon into tone */
  color: currentColor; /* same tone as text */
}
/* Pastel variations by module */
.badge[data-b="m2"] {
  background: linear-gradient(135deg, rgba(147,197,253,.15), rgba(99,102,241,.08));
}
.badge[data-b="m3"] {
  background: linear-gradient(135deg, rgba(190,242,100,.15), rgba(34,197,94,.08));
}
.badge[data-b="m4"] {
  background: linear-gradient(135deg, rgba(253,186,116,.15), rgba(245,158,11,.08));
}
.badge[data-b="m5"] {
  background: linear-gradient(135deg, rgba(196,181,253,.15), rgba(168,85,247,.08));
}

  
/* ---- Center badges + spacing from progress ---- */
.badges {
  margin-top: 24px; /* more space above */
  display: flex;
  justify-content: center; /* center align */
  flex-wrap: wrap;
  gap: 8px;
}

  
/* --- Badges: show only in Modules (hidden by default) --- */
#badgesRow{
  display:none;               /* hidden until course view */
  margin-top:24px;            /* space from progress */
  justify-content:center;     /* centered row */
  flex-wrap:wrap;
  gap:8px;
}

  </style>
</head>

<body>
  <header>
    <div class="wrap bar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div><b>Unicorn • Members Area</b>
      </div>
      <a class="support" href="#">
        <i class="fa-solid fa-headset"></i> Support
      </a>

    </div>
  </header>

  <main class="wrap">
    <nav class="tabs" id="tabs"></nav>

    <!-- Text-style module info -->
    <div class="module-info" id="moduleInfo"></div>
    <div class="progress">
      <div class="bar" id="progressBar"></div>
    </div>
    <div class="badges" id="badgesRow" style="display:none"></div>

    <!-- LIVE SALES TAB CONTENT -->
    <section class="sales-panel" id="salesPanel" aria-labelledby="salesTitle">

      <div class="content" style="padding:16px 16px 0;">
        <div class="sales-title" id="salesTitle">
          <span class="sales-ping"><span class="dot"></span> Live Sales</span>
          <span class="sales-muted">Recent purchases made via Unicorn</span>
        </div>
        <div class="sales-legend">
          <div class="sales-muted">Updates in real-time.</div>

        </div>
      </div>
      <div class="sales-head">
        <div>#</div>
        <div>Name</div>
        <div>Location</div>
        <div>Amount</div>
        <div>Time</div>
      </div>
      <div class="sales-body" id="salesBody"></div>
    </section>

    <section class="player-card">
      <div class="frame" id="frame"></div>
      <div class="content">
        <h2 class="title" id="title"></h2>
        <p class="desc" id="desc"></p>
        <div class="meta" id="meta"></div>
        <label class="complete-toggle"><input type="checkbox" id="completeToggle"> Mark this lesson complete</label>
        <div class="resources" id="resources" style="display:none"></div>
        <div class="tip" id="studentTip" style="display:none"></div>
        <div class="teaser" id="nextTeaser" style="display:none"></div>
      </div>
    </section>

    <div class="controls">
      <button class="pill" id="prevBtn">‹ Previous</button>
      <button class="pill" id="nextBtn">Next ›</button>
    </div>
  </main>

  <script>
    const modules = [
      {
        id: 'm1', title: 'MODULE 1', lessons: [
          { title: 'Welcome & Course Overview', desc: 'Get started with your transformation journey. Learn what to expect and set your intentions for the course.', time: '8:45', vimeo: 'https://player.vimeo.com/video/76979871', resources:[{type:'pdf',label:'Course Overview (PDF)',url:'#'},{type:'link',label:'Getting Started Checklist',url:'#'}] },
          { title: 'Foundation Building', desc: 'Set the right base for everything next.', time: '12:30', vimeo: 'https://player.vimeo.com/video/357274789' },
          { title: 'Mastery & Next Steps', desc: 'Wrap up and plan your next moves.', time: '14:40', vimeo: 'https://player.vimeo.com/video/395212534' }
        ]
      },
      {
        id: 'm2', title: 'MODULE 2', lessons: [
          { title: 'Content That Converts', desc: 'Create assets that drive action.', time: '10:32', vimeo: 'https://player.vimeo.com/video/76979871' },
          { title: 'Offer Positioning', desc: 'Make your offer obvious.', time: '8:07', vimeo: 'https://player.vimeo.com/video/357274789' },
          { title: 'Templates Walkthrough', desc: 'Move faster with systems.', time: '11:51', vimeo: 'https://player.vimeo.com/video/395212534' }
        ]
      },
      {
        id: 'm3', title: 'MODULE 3', lessons: [
          { title: 'Traffic Basics', desc: 'Signals that matter.', time: '9:22', vimeo: 'https://player.vimeo.com/video/76979871' },
          { title: 'Partner Amplification', desc: 'Grow with allies.', time: '10:50', vimeo: 'https://player.vimeo.com/video/357274789' },
          { title: 'Momentum Plan', desc: 'Sustain growth.', time: '7:37', vimeo: 'https://player.vimeo.com/video/395212534' }
        ]
      },
      {
        id: 'm4', title: 'MODULE 4', lessons: [
          { title: 'Analytics & Tracking', desc: 'Measure what matters.', time: '8:18', vimeo: 'https://player.vimeo.com/video/76979871' },
          { title: 'Optimization Loops', desc: 'Improve with feedback.', time: '9:56', vimeo: 'https://player.vimeo.com/video/357274789' },
          { title: 'Scaling Safely', desc: 'Grow without chaos.', time: '12:02', vimeo: 'https://player.vimeo.com/video/395212534' }
        ]
      },
      {
        id: 'm5', title: 'MODULE 5', lessons: [
          { title: 'Automation Basics', desc: 'Systems do the heavy lifting.', time: '9:05', vimeo: 'https://player.vimeo.com/video/76979871' },
          { title: 'Team & Delegation', desc: 'Free your time smartly.', time: '8:40', vimeo: 'https://player.vimeo.com/video/357274789' },
          { title: 'Roadmap Next 90 Days', desc: 'Plan your next wins.', time: '11:22', vimeo: 'https://player.vimeo.com/video/395212534' }
        ]
      }
    ];

    let currentModule = 0;
    let currentSlide = 0;
    let salesMode = false;

    // --- Show badges only on course view ---
    function updateBadgesVisibility(tab){
      const row = document.getElementById('badgesRow');
      if(!row) return;
      row.style.display = (tab === 'course') ? 'flex' : 'none';
    }


    // ---- Lesson completion storage ----
    function getCompleted(){
      try{ return JSON.parse(localStorage.getItem('unicorn_completed')||'{}'); }catch(e){ return {}; }
    }
    function setCompleted(obj){
      try{ localStorage.setItem('unicorn_completed', JSON.stringify(obj)); }catch(e){}
    }
    function setLessonCompleted(modIdx, slideIdx, done){
      const key = modules[modIdx].id;
      const st = getCompleted();
      const arr = Array.isArray(st[key]) ? st[key] : Array(modules[modIdx].lessons.length).fill(false);
      arr[slideIdx] = !!done;
      st[key] = arr;
      setCompleted(st);
    }
    function isLessonCompleted(modIdx, slideIdx){
      const st = getCompleted();
      const key = modules[modIdx].id;
      const arr = Array.isArray(st[key]) ? st[key] : [];
      return !!arr[slideIdx];
    }
    function isModuleComplete(modIdx){
      const st = getCompleted();
      const key = modules[modIdx].id;
      const arr = Array.isArray(st[key]) ? st[key] : [];
      return arr.length === modules[modIdx].lessons.length && arr.every(Boolean);
    }

    // ---- Override: unlock badge only when module complete ----
    function checkModuleBadge(modId){
      const idx = modules.findIndex(m => m.id === modId);
      if (idx < 0) return;
      if (isModuleComplete(idx)) unlockBadge(modId);
      else {
        // if not complete, don't add badge (leave existing badges as-is)
      }
    }


    // --- Student Tips per module ---
    const tipsByModule = {
      m1: '💡 <b>Tip:</b> Keep your first offer simple. Speed > perfection.',
      m2: '💡 <b>Tip:</b> Reuse your best hooks across multiple videos.',
      m3: '💡 <b>Tip:</b> Dominate one platform before adding another.',
      m4: '💡 <b>Tip:</b> Track only metrics that change decisions.',
      m5: '💡 <b>Tip:</b> Document processes so you can delegate.'
    };

    // --- Next Module Teasers ---
    const teasers = {
      m1: '<b>Next up:</b> Module 2 shows you how to turn views into action with Content That Converts.',
      m2: '<b>Next up:</b> Module 3 unlocks Momentum with traffic that compounds.',
      m3: '<b>Next up:</b> Module 4 gives you the analytics to optimize faster.',
      m4: '<b>Next up:</b> Module 5 sets the systems that free your time.',
      m5: '<b>Next up:</b> You finished the core! Revisit high-impact lessons and implement.'
    };

    // --- Badges ---
    function getBadges(){
      try{ return JSON.parse(localStorage.getItem('unicorn_badges')||'[]'); }catch(e){ return []; }
    }
    function setBadges(arr){
      try{ localStorage.setItem('unicorn_badges', JSON.stringify(arr)); }catch(e){}
    }
    function unlockBadge(modId){
      const cur = getBadges();
      if(!cur.includes(modId)){ cur.push(modId); setBadges(cur); }
      renderBadges();
    }
    function renderBadges(){
      const row = document.getElementById('badgesRow'); if(!row) return;
      const cur = getBadges();
      if(!cur.length){ row.style.display='none'; row.innerHTML=''; return; }
      const names = { m1:'Starter', m2:'Content Pro', m3:'Traffic Ace', m4:'Optimizer', m5:'Automator' };
      row.innerHTML = cur.map(id => `<span class="badge" data-b="${id}"><i class="fa-solid fa-award"></i>${names[id]||id}</span>`).join('');
      row.style.display='flex';
    }


    const tabs = document.getElementById('tabs');
    const frame = document.getElementById('frame');
    const titleEl = document.getElementById('title');
    const descEl = document.getElementById('desc');
    const metaEl = document.getElementById('meta');
    const moduleInfo = document.getElementById('moduleInfo');
    const progressBar = document.getElementById('progressBar');
    function showCourseView() {
      salesMode = false;
      document.body.classList.remove('sales-mode');
      document.getElementById('salesPanel').style.display = 'none';
      document.querySelector('.player-card').style.display = '';
      document.querySelector('.controls').style.display = '';
      document.getElementById('moduleInfo').style.display = '';
      document.querySelector('.progress').style.display = '';
      renderTabs(); renderSlide(); updateBadgesVisibility("course");
    ; updateBadgesVisibility("course"); }
    function showSalesView() {
      salesMode = true;
      document.body.classList.add('sales-mode');
      const panel = document.getElementById('salesPanel');
      panel.style.display = 'block';
      document.querySelector('.player-card').style.display = 'none';
      document.querySelector('.controls').style.display = 'none';
      document.getElementById('moduleInfo').style.display = 'none';
      document.querySelector('.progress').style.display = 'none';
      renderTabs();
      // tell the sales feed to seed rows immediately
      window.dispatchEvent(new CustomEvent('enterSalesTab'));
    ; updateBadgesVisibility("sales"); }


    function renderTabs() {
      const modTabs = modules
        .map((m, i) => `<button class="tab ${i === currentModule && !salesMode ? 'active' : ''}" data-i="${i}">${m.title}</button>`)
        .join('');

      // Make Live Sales pink when selected
      const salesTab = `<button class="tab ${salesMode ? 'active' : ''}" data-sales="1">LIVE SALES</button>`;

      tabs.innerHTML = modTabs + salesTab;
    }




    function setPlayer(url) {
      frame.innerHTML = `<iframe src="${url}?title=0&byline=0&portrait=0" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`;
      const ifr = frame.querySelector('iframe');
      ifr.addEventListener('load', () => ifr.classList.add('loaded'), { once: true });
    }

    function updateModuleInfo() {
      const mod = modules[currentModule];
      const total = mod.lessons.length;
      const idx = currentSlide + 1;
      moduleInfo.innerHTML = `
      <span class="label">Module</span> <span class="value">${mod.title.replace('MODULE ', '')}</span>
      <span class="sep">•</span>
      <span class="label">Lessons</span> <span class="value">${total}</span>
      <span class="sep">•</span>
      <span class="now"><span class="dot"></span> <span class="tag">Now playing</span> <span class="fraction"><span class="cur">${idx}</span><span class="slash">/</span>${total}</span></span>
    `;
      const pct = (idx / total) * 100;
      progressBar.style.width = pct + '%';
    }

    
    function renderSlide() {
      const mod = modules[currentModule];
      const lesson = mod.lessons[currentSlide];
      setPlayer(lesson.vimeo);
      titleEl.textContent = lesson.title;
      descEl.textContent = lesson.desc || "";
      metaEl.textContent = lesson.time ? `⏱ ${lesson.time}` : "";

      // Resources per lesson
      const resEl = document.getElementById('resources');
      if (lesson.resources && lesson.resources.length) {
        const list = lesson.resources.map(r => {
          const kind = (r.type || 'LINK').toUpperCase();
          return `<li><a class="pill-link" href="${r.url}" target="_blank" rel="noopener">
                    <span class="kind">${kind}</span><span>${r.label}</span>
                  </a></li>`;
        }).join('');
        resEl.innerHTML = `<h3>Resources</h3><ul>${list}</ul>`;
        resEl.style.display = 'block';
      } else {
        resEl.innerHTML = '';
        resEl.style.display = 'none';
      }

      // Student tip (per module)
      const tipEl = document.getElementById('studentTip');
      const tip = tipsByModule[mod.id];
      if (tip) { tipEl.innerHTML = tip; tipEl.style.display = 'block'; }
      else { tipEl.style.display = 'none'; }

      // Teaser (if on last lesson)
      const isLast = currentSlide === mod.lessons.length - 1;
      const tzEl = document.getElementById('nextTeaser');
      if (isLast) {
        tzEl.innerHTML = teasers[mod.id] || '';
        tzEl.style.display = tzEl.innerHTML ? 'block' : 'none';
        // Badge unlock moved to completion check
        checkModuleBadge(mod.id);
      } else {
        tzEl.style.display = 'none';
        tzEl.innerHTML = '';
      }

      updateModuleInfo();

      // Sync completion toggle
      const toggle = document.getElementById('completeToggle');
      if (toggle){
        toggle.checked = isLessonCompleted(currentModule, currentSlide);
        toggle.onchange = function(){
          setLessonCompleted(currentModule, currentSlide, this.checked);
          // if that action makes the whole module complete, award badge
          checkModuleBadge(mod.id);
          renderBadges();
        };
      }

      renderBadges();
    }


    document.getElementById('prevBtn').addEventListener('click', () => {
      const L = modules[currentModule].lessons.length;
      currentSlide = (currentSlide - 1 + L) % L; renderSlide();
    });
    document.getElementById('nextBtn').addEventListener('click', () => {
      const L = modules[currentModule].lessons.length;
      currentSlide = (currentSlide + 1) % L; renderSlide();
    });
    tabs.addEventListener('click', e => {
      const b = e.target.closest('.tab'); if (!b) return;
      if (b.dataset.sales) { showSalesView(); return; }
      const i = parseInt(b.dataset.i, 10);
      currentModule = i; currentSlide = 0; showCourseView();
    });

    // Keyboard navigation
    window.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') document.getElementById('prevBtn').click();
      if (e.key === 'ArrowRight') document.getElementById('nextBtn').click();
    });

    // Init
    renderTabs(); renderSlide(); updateBadgesVisibility("course"); renderBadges();
    // sales panel off initially
    document.getElementById('salesPanel').style.display = 'none';
  </script>

  <script>

    // --- Live Sales Feed (demo) ---
    (function () {
      const body = document.getElementById('salesBody');
      let rank = 0;
      const baseRank = Math.floor(Math.random() * 901);

      // American women 30+ (sample names)
      const names = [
        "Jessica Miller", "Ashley Johnson", "Amanda Davis", "Sarah Wilson", "Megan Anderson", "Brittany Thompson", "Nicole Martinez",
        "Rachel Taylor", "Kimberly Moore", "Samantha Jackson", "Heather White", "Erin Harris", "Christina Lewis", "Tiffany Walker",
        "Danielle Hall", "Courtney Allen", "Brooke Young", "Vanessa King", "Lauren Wright", "Katie Scott", "Amber Green", "Erica Adams",
        "Katherine Baker", "Natalie Nelson", "Lisa Carter", "Monica Mitchell", "Hannah Perez", "Allison Roberts", "Whitney Turner", "Alyssa Phillips",
        "Shannon Campbell", "Kelly Parker", "Chelsea Evans", "Morgan Edwards", "Jasmine Collins", "Alicia Stewart", "Bianca Sanchez", "Julia Morris"
      ];

      // City/State combos like "Boise, Idaho"
      const locations = [
        "Boise, Idaho", "Miami, Florida", "Tampa, Florida", "Austin, Texas", "Dallas, Texas", "Phoenix, Arizona", "Mesa, Arizona",
        "Nashville, Tennessee", "Memphis, Tennessee", "Charlotte, North Carolina", "Raleigh, North Carolina", "Columbus, Ohio",
        "Cleveland, Ohio", "Detroit, Michigan", "Grand Rapids, Michigan", "Madison, Wisconsin", "Milwaukee, Wisconsin",
        "Albany, New York", "Buffalo, New York", "Rochester, New York", "Pittsburgh, Pennsylvania", "Philadelphia, Pennsylvania",
        "Richmond, Virginia", "Norfolk, Virginia", "Charleston, South Carolina", "Savannah, Georgia", "Atlanta, Georgia",
        "Birmingham, Alabama", "New Orleans, Louisiana", "Omaha, Nebraska", "Lincoln, Nebraska", "Sioux Falls, South Dakota",
        "Fargo, North Dakota", "Salt Lake City, Utah", "Provo, Utah", "Denver, Colorado", "Colorado Springs, Colorado",
        "Portland, Oregon", "Eugene, Oregon", "Seattle, Washington", "Spokane, Washington"
      ];

      function pick(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

      // Amount from $40 - $700, slightly clustered around ~150-300, but with full-range coverage
      function randomAmount() {
        // mixture: 70% normal-ish around 240, 30% uniform across range
        if (Math.random() < 0.7) {
          // Box-Muller for normal-like distribution
          let u = 0, v = 0;
          while (u === 0) u = Math.random();
          while (v === 0) v = Math.random();
          let num = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
          let val = 240 + num * 120; // mean 240, std 120
          val = Math.min(700, Math.max(40, val));
          // add cents .00 - .99
          const cents = Math.floor(Math.random() * 100);
          return Math.floor(val) + cents / 100;
        } else {
          const val = 40 + Math.random() * (700 - 40);
          const cents = Math.floor(Math.random() * 100);
          return Math.floor(val) + cents / 100;
        }
      }

      function fmtAmount(n) { return '$' + n.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 }); }
      function formatTime(d) {
        return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
      }

      function addRow(name, location, amount, when) {
        rank += 1;
        const row = document.createElement('div');
        row.className = 'sales-row';
        row.innerHTML = `
      <div class="sales-rank">${baseRank + rank}</div>
      <div>${name}</div>
      <div>${location}</div>
      <div class="sales-amount">${fmtAmount(amount)}</div>
      <div class="sales-time">${formatTime(when || new Date())}</div>
    `;
        body.prepend(row);
        // cap at 30 rows, remove older ones
        while (body.children.length > 30) body.removeChild(body.lastElementChild);
      }

      function randomSale() {
        addRow(pick(names), pick(locations), randomAmount(), new Date());
      }

      // Variable timing: sometimes fast (3-6s), sometimes slow (up to ~30s)
      function scheduleNext() {
        const fast = Math.random() < 0.6;
        const delay = fast ? (1000 + Math.random() * 2000) : (5000 + Math.random() * 7000); // ~1-3s or 5-12s
        setTimeout(() => {
          randomSale();
          scheduleNext();
        }, delay);
      }

      // seed when entering tab (ensure 30 exist)
      window.addEventListener('enterSalesTab', () => {
        try {
          if (body.children.length < 30) {
            for (let i = body.children.length; i < 30; i++) {
              const agoSec = Math.floor(Math.random() * (30 * 60));
              const when = new Date(Date.now() - agoSec * 1000);
              addRow(pick(names), pick(locations), randomAmount(), when);
            }
          }
        } catch (e) { }
      });

      // expose manual seed (optional)
      window.__unicornSales = window.__unicornSales || {};
      window.__unicornSales.seed = () => { for (let i = body.children.length; i < 30; i++) randomSale(); };

      // also generate even if not viewing the tab so it's ready
      (function bootstrap() {
        for (let i = 0; i < 30; i++) {
          const agoSec = Math.floor(Math.random() * (30 * 60));
          const when = new Date(Date.now() - agoSec * 1000);
          addRow(pick(names), pick(locations), randomAmount(), when);
        }
        scheduleNext();
      })();
    })();
  </script>

  <!-- One-time welcome (localStorage + optional server check) -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <script>
    // Optional: set this globally after login to tie the flag to a user
    // window.UNICORN_USER_ID = "user-uuid-or-email-hash";
    (function () {
      const KEY = "unicorn_seen_welcome";
      const COOKIE = "unicorn_seen_welcome=1; Max-Age=31536000; Path=/; SameSite=Lax";
      const userId = window.UNICORN_USER_ID || null;

      function prefersReducedMotion() {
        return window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      }

      function getCookie(name) {
        const m = document.cookie.match(new RegExp('(?:^|; )' + name.replace(/[.$?*|{}()\[\]\\/+^]/g, '\\$&') + '=([^;]*)'));
        return m ? decodeURIComponent(m[1]) : null;
      }

      function launchConfetti() {
        if (prefersReducedMotion()) return;
        const duration = 2000;
        const end = Date.now() + duration;
        (function frame() {
          confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 } });
          confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 } });
          if (Date.now() < end) requestAnimationFrame(frame);
        })();
      }

      function injectStyles() {
        if (document.getElementById("u-welcome-styles")) return;
        const css = `
        .u-welcome-overlay{
          position:fixed; inset:0; display:grid; place-items:center;
          background:rgba(0,0,0,.55); backdrop-filter:saturate(120%) blur(3px);
          z-index:10000; opacity:1; transition:opacity .2s ease;
        }
        .u-welcome-overlay.hide{ opacity:0; }
        .u-welcome-modal{
          width:min(520px,92vw);
          background: var(--panel, #151313);
          color: var(--text, #f5f4f2);
          border:1px solid var(--line, rgba(255,255,255,.08));
          border-radius: var(--radius, 16px);
          box-shadow: var(--shadow, 0 12px 28px rgba(0,0,0,.45));
          padding: 26px 22px;
          text-align:center;
        }
        .u-welcome-icon{ font-size:34px; margin-bottom:6px; }
        .u-welcome-title{
          margin:8px 0 6px; font-size:24px; line-height:1.15;
          color: var(--pink, #f06292); font-weight:900; letter-spacing:.2px;
        }
        .u-welcome-text{ margin:0 0 14px; color:#e9e0d5; }
        .u-welcome-btn{
          padding:10px 18px; border-radius:12px; border:1px solid var(--line, rgba(255,255,255,.08));
          background: var(--pink, #f06292); color:#1a0d13; font-weight:800; cursor:pointer;
        }
        @media (max-width: 520px){ .u-welcome-title{ font-size:22px; } }
      `;
        const style = document.createElement("style");
        style.id = "u-welcome-styles";
        style.textContent = css;
        document.head.appendChild(style);
      }

      function showPopup() {
        const overlay = document.createElement("div");
        overlay.className = "u-welcome-overlay";
        overlay.setAttribute("role", "dialog");
        overlay.setAttribute("aria-modal", "true");
        overlay.innerHTML = `
        <div class="u-welcome-modal">
          <div class="u-welcome-icon">🎉</div>
          <h2 class="u-welcome-title">Congratulations!</h2>
          <p class="u-welcome-text">You've unlocked your copy of Unicorn.<br><b>Select any module below</b> to get started.</p>
          <button class="u-welcome-btn" id="uWelcomeBtn">Let's goo!</button>
        </div>
      `;
        document.body.appendChild(overlay);
        function close() {
          overlay.classList.add("hide");
          setTimeout(() => overlay.remove(), 200);
        }
        overlay.addEventListener("click", (e) => { if (e.target === overlay) close(); });
        document.getElementById("uWelcomeBtn").addEventListener("click", close);
      }

      async function apiGetSeen() {
        if (!userId) return false;
        try {
          const r = await fetch(`/api/welcome-status?user=${encodeURIComponent(userId)}`, { credentials: "include" });
          if (!r.ok) return false;
          const j = await r.json();
          return !!j.seen;
        } catch { return false; }
      }

      async function apiSetSeen() {
        if (!userId) return;
        try {
          await fetch(`/api/welcome-status`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            credentials: "include",
            body: JSON.stringify({ user: userId, seen: true }),
          });
        } catch { }
      }

      function markSeenClient() {
        try {
          localStorage.setItem(KEY, "1");
        } catch { }
        document.cookie = COOKIE;
      }

      async function initWelcome() {
        const localSeen = !!(function () { try { return localStorage.getItem(KEY); } catch (e) { return null; } })();
        const cookieSeen = !!getCookie("unicorn_seen_welcome");
        const serverSeen = await apiGetSeen();
        const shouldShow = !(localSeen || cookieSeen || serverSeen);

        if (shouldShow) {
          injectStyles();
          launchConfetti();
          setTimeout(showPopup, 500);
          markSeenClient();
          apiSetSeen();
        }
      }

      // Kick off after DOM is ready
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initWelcome);
      } else {
        initWelcome();
      }
    })();
  </script>

</body>

</html>